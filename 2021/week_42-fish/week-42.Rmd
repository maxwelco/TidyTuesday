---
title: "week-42" 
author: "Maxwel Coura Oliveira"
date: "10/12/2021"
output: html_document
---

```{r}
consumption <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/fish-and-seafood-consumption-per-capita.csv')
```

```{r}
library(countrycode)
library(treemapify)
library(tidyverse)
library(ggtext)
```

```{r}
codelist |> 
  dplyr::select(continent, iso3c, country.name.en) -> continent
```

```{r}
consumption |> 
  janitor::clean_names() |> 
  filter(!is.na(code)) |> 
  left_join(continent, by = c("code" = "iso3c")) |> 
  filter(!is.na(entity)) |> 
  rename(per_capita = fish_seafood_food_supply_quantity_kg_capita_yr_fao_2020) |> 
  mutate_if(is_character, as_factor) -> consumption1
```

```{r}
library(extrafont)
library(showtext)
showtext_auto()
font_add_google("Oswald", "oswald")
font_add_google("Lato", "lato")
```




```{r}
consumption1 |> 
  filter(year == 2017) |>  
  ggplot(aes(area = per_capita, 
             fill = per_capita, 
             label = entity,
             subgroup = continent)) +
  geom_treemap(show.legend = FALSE) +
  geom_treemap_subgroup_border() +
  geom_treemap_subgroup_text(place = "centre", 
                             family = "oswald",
                             grow = TRUE, 
                             alpha = 0.5, 
                             color = "#333333", 
                             min.size = 0.1) +
  geom_treemap_text(fontface = "italic", 
                    color = "#F9F6EE",
                    family = "lato",
                    place = "centre",
                    min.size = 0.1,
                    grow = TRUE) +
  labs(title = "Global per capita seafood consumption",
       subtitle = "Proportion of seafood consumption for a country population within a continent in 2017",
       caption = "**Source:** OurWorldinData.org | **Figure:** @maxwelco") +
  scale_fill_viridis_c(option = "H") +
  theme(legend.position = "none",
        plot.title = element_markdown(family = "oswald",
                                      size = 60),
        plot.subtitle = element_markdown(family = "lato",
                                         size = 20),
        plot.caption = element_markdown(family = "lato",
                                         size = 10),
        plot.background = element_rect(fill = "#F9F6EE"))

ggsave("fig_42.png")
```


