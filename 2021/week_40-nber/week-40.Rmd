---
title: "week-40"
author: "Maxwel Coura Oliveira"
date: "9/27/2021"
output: html_document
---

```{r}
library(tidyverse)
library(ggthemes)
```


```{r}
papers <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-28/papers.csv')
authors <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-28/authors.csv')
programs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-28/programs.csv')
paper_authors <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-28/paper_authors.csv')
paper_programs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-28/paper_programs.csv')

```
```{r}
programs |> 
  left_join(paper_programs, by = "program") |> 
  left_join(papers, by = "paper") |> 
  left_join(paper_authors, by = "paper") |> 
  left_join(authors, by = "author") -> data
```

```{r}
library(scales)
data |> 
  mutate(decade = case_when(
    year <= 1980 ~ "1970s",
    year > 1980 & year <= 1990 ~ "1980s",
    year > 1990 & year <= 2000 ~ "1990s",
    year > 2000 & year <= 2010 ~ "2000s",
    year > 2010 & year <= 2020 ~ "2010s",
    year > 2020 ~ "2020s",
  )) |> 
  count(program_desc, decade) -> data1 #|> 
#  mutate_at(vars(-program_desc, -decade), rescale) -> data1
```





```{r}
data1 %>%
  ggplot(aes(x = decade, y = program_desc, fill = n)) + 
  geom_tile() +
  scale_fill_viridis_c(option = "H") +
  theme_minimal() +
  labs(title = NULL,
       y = NULL,
       x = NULL) +
  theme(legend.position = "bottom")
```

