---
title: "week-32"
author: "Maxwel Coura Oliveira"
date: "8/2/2021"
output: html_document
---


```{r}
library(tidyverse)
library(ggflags)
library(ggtext)
library(ggthemes)
```



```{r}
athletes <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-08-03/athletes.csv')
```


```{r}
athletes %>% 
  filter(abb == "BRA" & type == "Swimming") %>% 
  count(gender, athlete, medal) %>% 
  pivot_wider(id_cols = c(gender, athlete),
              names_from = medal, values_from = n) %>% 
  mutate_if(is.integer, ~replace_na(., 0)) %>% 
  mutate(total = Gold + Silver + Bronze) %>% 
  group_by(gender) %>% 
  arrange(desc(total)) %>% 
  mutate(Rank = row_number()) %>% 
  filter(gender == "Men" & Rank <= 9 | gender == "Women") %>% 
  filter(!is.na(athlete)) %>% 
  pivot_longer(cols = c("Gold", "Silver", "Bronze"), 
               names_to = "medal", 
               values_to = "n") -> athletes1
```

```{r}
athletes1 %>% 
  ggplot(aes(x = fct_reorder(athlete, total), y = total, fill = medal)) +
#  facet_wrap(~gender, scales = "free") +
  coord_flip() +
  labs(x = NULL, y = NULL) +
  geom_point(data = athletes1 %>% filter(medal == "Gold"), size = 6) +
  geom_emoji(emoji = "1f3ca") +
  scale_fill_manual(values = c("#cd7f32", "#d6d6d6", "Gold")) +
#  theme_void() +
  theme(panel.background = element_rect(fill = "#b8e9ee"),
        plot.background = element_rect(fill = "gray90"),
        strip.text = element_markdown(size = 15),
        legend.position = "none") 
```



